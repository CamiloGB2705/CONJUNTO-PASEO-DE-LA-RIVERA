// Prisma schema for MySQL provider

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

enum Role {
    RESIDENT
    ADMIN
    SUPERADMIN
}

enum PQRSTipo {
    PREGUNTA
    QUEJA
    RECLAMO
    SUGERENCIA
}

enum PQRSEstado {
    PENDIENTE
    EN_PROCESO
    RESUELTO
}

enum ReservaEstado {
    PENDIENTE
    APROBADA
    RECHAZADA
}

model User {
    id        String     @id @default(cuid())
    name      String
    email     String     @unique
    password  String
    role      Role       @default(RESIDENT)
    reservas  Reserva[]
    pqrs      PQRS[]
    auditLogs AuditLog[]
    createdAt DateTime   @default(now())
    updatedAt DateTime   @updatedAt
}

model PQRS {
    id        String     @id @default(cuid())
    tipo      PQRSTipo
    mensaje   String
    estado    PQRSEstado @default(PENDIENTE)
    user      User       @relation(fields: [userId], references: [id])
    userId    String
    createdAt DateTime   @default(now())
}

model Zona {
    id          String    @id @default(cuid())
    nombre      String
    descripcion String?
    horario     String?
    reservas    Reserva[]
}

model Reserva {
    id        String        @id @default(cuid())
    fecha     DateTime
    estado    ReservaEstado @default(PENDIENTE)
    zona      Zona          @relation(fields: [zonaId], references: [id])
    zonaId    String
    user      User          @relation(fields: [userId], references: [id])
    userId    String
    createdAt DateTime      @default(now())
}

model Anuncio {
    id        String   @id @default(cuid())
    titulo    String
    contenido String
    createdAt DateTime @default(now())
}

model AuditLog {
    id        String   @id @default(cuid())
    user      User?    @relation(fields: [userId], references: [id])
    userId    String?
    action    String
    ip        String?
    createdAt DateTime @default(now())
}
